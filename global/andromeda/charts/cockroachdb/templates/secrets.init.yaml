{{- if .Values.init.provisioning.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cockroachdb.fullname" . }}-init
  namespace: {{ .Release.Namespace | quote }}
type: Opaque
data:

{{- range $user := .Values.init.provisioning.users }}
{{- if $user.password }}
  {{ $user.name }}-password: {{ $user.password | b64enc }}
{{- end }}
{{- end }}

{{- range $clusterSetting, $clusterSettingValue := .Values.init.provisioning.clusterSettings }}
  {{ $clusterSetting | replace "." "-" }}-cluster-setting: {{ $clusterSettingValue | b64enc }}
{{- end }}

{{- end }}
